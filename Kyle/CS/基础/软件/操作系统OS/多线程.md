### 为什么要有多线程？

让一个进程可以同时做多件事情；

一般用于处理耗时的操作：网络请求，IO操作，AI等；

### 怎么实现多线程？

通过代码可以创建主线程以外的线程；

线程共享进程的大部分资源，并参与CPU的调度；（**共享内存**）

### 多线程的应用

-   解压缩资源
-   IO操作
-   网络请求
-   大量的数据操作
-   一些资源的加载

---

-   多线程注意事项
    
    ### 1、明确目的
    
    如果是由于单线程读写或者网络访问（例如HTTP访问互联网）的瓶颈，可以考虑使用线程池。
    
    如果是对不同的资源（例如SOCKET连接）进行管理，可以考虑多个线程。
    
    ### 2、如何控制线程的调度和阻塞
    
    例如利用事件的触发来控制线程的调度和阻塞，也有用消息来控制的。
    
    ### 3、公共资源的线程安全性
    
    一般用LOCK锁机制来控制线程安全性。一定要保证不要有死锁机制。
    
    ### 4、合理使用sleep
    
    何时Sleep，Sleep的大小要根据具体项目，做出合理安排。一般原则非阻塞状态下每个循环都要有SLeep，这样保证减少线程对CPU的抢夺。每次线程的就绪和激活都会占用一定得资源，如果线程体如果有多个循环，多处使用SLEEP将导致性能的下降。
    
    ### 5、线程的终止
    
    一般要使线程体在完成一件工作的情况下终止，一般不要直接使用抛出线程异常的方式终止线程。
    
    ### 6、线程的优先级
    
    一定根据程序的需要要有个整体的规划
    

### 原子问题

如果多线程是同步操作一个原子数据，(多个线程同步去处理一个加锁的对象)，那效率肯定不会提升，就好像1个人去做1件事和多个人排队去做一件事效率是一样的；

### 对硬盘的读写

对磁盘进行多线程处理的时候，效率会急速下降！！因为不同文件的读写，会造成磁头的频繁转换，磁头的频繁转换要比读取磁盘的时间更长。所以这种情况下，最好有个线程去读取文件，其他的线程去处理文件数据中的业务逻辑处理；

机械磁盘只能同时一个线程访问，所以多线程的读取效率可能还不如单线程；

计算机磁盘的磁头只有一个，即使多条线程去读也并不能提高读取效率，反而因为多线程的上下文切换问题会耗时更久；

操作系统的IO通道数量的影响：

采用普通的File文件API来读写多文件.使用多线程的话很大程度上也不会提高效率；

因为文件，网络等流的读写都需要操作IO通道，而操作系统的IO通道数量是固定的；

我们假设你的电脑只有一个IO通道，如果你打开一个文件流并进行读写，则占用了一个IO通道，如果你又打开一个文件流，则第二个文件流需要等待第一个文件关闭通道才能真正意义上的进行读写。 所以实际上，你打开多个文件同时进行读写时就是在串行单线程操作；

过度使用或误用 I/O 是导致应用程序效率低下的常见原因。

同步是指代码调用 IO 操作时，必须等待 IO 操作完成才返回的调用方式。

异步是指代码调用 IO 操作时，不必等 IO 操作完成就返回的调用方式。